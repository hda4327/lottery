(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/drawToCanvas/DrawToCanvas"],{1049:function(t,e,a){"use strict";a.r(e);var n=a("4042"),i=a.n(n);for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);e["default"]=i.a},"3a18":function(t,e,a){"use strict";a.r(e);var n=a("6e97"),i=a("1049");for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);a("4de3");var o=a("2877"),s=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"8aee102a",null);e["default"]=s.exports},4042:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={name:"DrawToCanvas",data:function(){return{poster:"",isCreate:!1,isShow:!1,bgWidth:670,bgHeight:1084,userInfo:{},tip:"",proportion:"",salary:""}},components:{},onReady:function(){this.userInfo=JSON.parse(t.getStorageSync("userInfo")),this.tip=t.getStorageSync("tip"),this.proportion=t.getStorageSync("proportion"),this.salary=t.getStorageSync("total"),this.createPoster()},computed:{ratepx:function(){return 750/t.getSystemInfoSync().windowWidth}},methods:{rate:function(t){return t/this.ratepx},createPoster:function(){var t=this,e={bigImage:"../../static/img/res-bg.png",contentBg:"../../static/img/res-line.png",avatar:this.userInfo.avatarUrl,code:"../../static/img/code.png",t1:"你最匹配的年薪是",t2:"已超过了"+this.proportion+"的口腔从业者",t3:"长按测一测您的匹配薪资",t4:this.salary+"！",content:this.tip,name:this.userInfo.nickName,appName:this.userInfo.nickName};this.draw("poster",this.bgWidth,this.bgHeight,e).then(function(e){setTimeout(function(){t.isCreate=!0,t.isShow=!0},300)},function(t){setTimeout(function(){console.log("生成海报失败")},300)})},catchtap:function(t){var e=this;this.isShow=!1,setTimeout(function(){e.isCreate=!1,t&&"function"==typeof t&&t()},400)},drawText:function(t){var e=Math.ceil(t.ctx.measureText(t.str).width/t.maxWidth),a=e>=t.maxLine?t.maxLine:e,n=0;t.ctx.setFillStyle(t.style?t.style:"#fff"),t.ctx.setFontSize(t.fontSize?t.fontSize:this.rate(24));for(var i=0;i<=a;i++){var r=t.str.slice(n),o=0,s=t.y+(1==a?0:i*t.height),l=r.length;if(!(t.ctx.measureText(r).width>t.maxWidth)){t.ctx.fillText(r.slice(0),t.x,s);break}for(var c=0;c<l;c++)if(console.log(l),console.log("m",c),o+=t.ctx.measureText(r[c]).width,o>t.maxWidth){i===t.maxLine-1?t.ctx.fillText(r.slice(0,c-1)+"...",t.x,s):t.ctx.fillText(r.slice(0,c),t.x,s),n+=c;break}}},draw:function(e,a,n,i){var r=this;return new Promise(function(o,s){var l=t.createCanvasContext(e,r);l.clearRect(0,0,r.rate(a),r.rate(n)),l.setFillStyle("white"),l.fillRect(0,0,r.rate(a),r.rate(n)),l.drawImage(i.bigImage,0,0,r.rate(a),r.rate(1084)),l.drawImage(i.contentBg,r.rate(40),r.rate(180),r.rate(590),r.rate(321)),r.drawText({ctx:l,str:i.content,maxLine:4,maxWidth:r.rate(500),x:r.rate(95),y:r.rate(558),height:r.rate(50),fontSize:r.rate(24)}),l.save(),l.setFillStyle("#BC30FF"),l.setFontSize(r.rate(28)),l.fillText(i.t3,r.rate(182),r.rate(985)),l.save(),l.setFillStyle("#fff"),l.setFontSize(r.rate(36)),l.fillText(i.name,r.rate(174),r.rate(100)),l.save(),l.setFillStyle("#0071BC"),l.setFontSize(r.rate(48)),l.font="700",l.fillText(i.t1,r.rate(145),r.rate(259)),l.save(),l.setFillStyle("#BC30FF"),l.setFontSize(r.rate(80)),l.font="700",l.fillText(i.t4,r.rate(200),r.rate(370)),r.boldText(l,{text:i.t4,x:r.rate(200),y:r.rate(370)}),l.save(),l.setFillStyle("#0071BC"),l.setFontSize(r.rate(26)),l.fillText(i.t2,r.rate(170),r.rate(465)),l.save(),l.drawImage(i.avatar,r.rate(50),r.rate(40),r.rate(100),r.rate(100)),l.drawImage(i.code,r.rate(265),r.rate(725),r.rate(140),r.rate(140)),l.draw(!1,function(e){t.canvasToTempFilePath({canvasId:"poster",fileType:"png",success:function(t){r.poster=t.tempFilePath,o()},fail:function(t){console.log(t),s()}},r)})})},boldText:function(t,e){t.fillText(e.text,e.x,e.y-.8),t.fillText(e.text,e.x-.8,e.y)},btnCreate:function(){wx.saveImageToPhotosAlbum({filePath:this.poster,success:function(e){t.showToast({title:"保存成功"})},fail:function(e){t.showToast({title:"保存失败",icon:"none"})}},this)},roundRect:function(t,e,a,n,i,r){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"#fff";n<2*r&&(r=n/2),i<2*r&&(r=i/2),t.beginPath(),t.fillStyle=o,t.arc(e+r,a+r,r,Math.PI,1.5*Math.PI),t.moveTo(e+r,a),t.lineTo(e+n-r,a),t.lineTo(e+n,a+r),t.arc(e+n-r,a+r,r,1.5*Math.PI,2*Math.PI),t.lineTo(e+n,a+i-r),t.lineTo(e+n-r,a+i),t.arc(e+n-r,a+i-r,r,0,.5*Math.PI),t.lineTo(e+r,a+i),t.lineTo(e,a+i-r),t.arc(e+r,a+i-r,r,.5*Math.PI,Math.PI),t.lineTo(e,a+r),t.lineTo(e+r,a),t.fill(),t.closePath()},drawRound:function(t){}}};e.default=a}).call(this,a("543d")["default"])},"4de3":function(t,e,a){"use strict";var n=a("fb08"),i=a.n(n);i.a},"6e97":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c},i=[];a.d(e,"a",function(){return n}),a.d(e,"b",function(){return i})},fb08:function(t,e,a){}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/drawToCanvas/DrawToCanvas-create-component',
    {
        'components/drawToCanvas/DrawToCanvas-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("3a18"))
        })
    },
    [['components/drawToCanvas/DrawToCanvas-create-component']]
]);                
